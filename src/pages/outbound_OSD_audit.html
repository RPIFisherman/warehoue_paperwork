<!-- Transaction Log -->
<!-- Modified by: Yuyang Gong -->
<!-- Edited on: 01/13.2026 -->
<!-- Jira: WISE2018-33155 -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transaction Log</title>
    <link rel="stylesheet" href="../styles/print_form.css" />
    <link rel="stylesheet" href="../styles/transaction_log.css" />
  </head>

  <body>
    <button class="print-button" onclick="window.triggerPrint('transaction')">
      ðŸ–¨ Print
    </button>
    <div class="container">
      <!-- ========== HEADER SECTION ========== -->
      <div class="header-container">
        <div class="header-left">
          <div class="print-time">
            Print time: <span class="important">01/13/26 02:11:13 PM</span>
          </div>
        </div>
        <h1>Transaction Log</h1>
        <div class="header-left" style="text-align: right">
          <div class="print-time">
            Print Qty: <span class="important">1</span>
          </div>
        </div>
      </div>

      <!-- ========== ITEM INFORMATION SECTION ========== -->
      <div class="section">
        <h2>Item Information</h2>
        <div class="info-section-with-images">
          <div class="info-section-content">
            <div class="info-section">
              <div class="info-row">
                <span class="info-label">ITEM:</span>
                <span class="underline">32Q31K</span>
              </div>
              <div class="info-row">
                <span class="info-label">Stack Height:</span>
                <span class="underline">2</span>
              </div>
            </div>

            <div class="info-section">
              <div class="info-row">
                <span class="info-label">BaseUOM:</span>
                <div class="checkbox-group">
                  <div class="manual-check">
                    <span class="checkbox"></span
                    ><span class="checkdesc">EA</span>
                  </div>
                  <div class="manual-check">
                    <span class="checkbox"></span
                    ><span class="checkdesc">CS</span>
                  </div>
                  <div class="manual-check">
                    <span class="checkbox"></span
                    ><span class="checkdesc">PLT</span>
                  </div>
                </div>
              </div>
              <div class="info-row">
                <span class="info-label">Customer:</span>
                <span class="underline">TCL NORTH AMERICA</span>
              </div>
            </div>

            <div class="info-section">
              <div class="info-row">
                <span class="info-label">Rcv Date:</span>
                <span class="underline">01/07/2026</span>
              </div>
              <div class="info-row">
                <span class="info-label">Hazardous:</span>
                <div class="checkbox-group">
                  <div class="manual-check">
                    <span class="checkbox"></span
                    ><span class="checkdesc">Yes</span>
                  </div>
                  <div class="manual-check">
                    <span class="checkbox"></span
                    ><span class="checkdesc">No</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="info-section">
              <div class="info-row">
                <span class="info-label">Expy Date:</span>
                <span class="underline"></span>
              </div>
              <div class="info-row">
                <span class="info-label">Location:</span>
                <span class="underline">01.001</span>
              </div>
            </div>
          </div>

          <div class="image-section">
            <div class="image-container">
              <img
                src="../../assets/images/43Q31K.webp"
                alt="Item Image"
                class="item-image"
              />
            </div>
          </div>

          <div class="qr-code-section">
            <a href="http://localhost:3000" aria-label="Open label server">
              <img src="../../assets/images/qr.png" alt="QR Code" />
            </a>
          </div>
        </div>
      </div>

      <!-- ========== TRANSACTION TABLE SECTION ========== -->
      <div class="section">
        <h2>Transaction Records</h2>
        <table>
          <thead>
            <tr>
              <th style="width: 60px">DATE<br />MM/DD</th>
              <th>Transaction TYPE</th>
              <th style="width: 100px">RN/DN/Task #</th>
              <th style="width: 60px">QTY</th>
              <th style="width: 80px">BALANCE</th>
              <th style="width: 80px">Initial Signature</th>
              <th style="width: 60px">Sign</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-weight: 600">
              <td></td>
              <td>
                <div class="transaction-type">
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >CC
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad+
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad-
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PT
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PI
                  </div>
                </div>
              </td>
              <td></td>
              <td></td>
              <td>Initial Balance</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>1/7</td>
              <td>
                <div class="transaction-type">
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >CC
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad+
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad-
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PT
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PI
                  </div>
                </div>
              </td>
              <td>RN-12345</td>
              <td>1200</td>
              <td>1200</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>1/8</td>
              <td>
                <div class="transaction-type">
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >CC
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad+
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >Ad-
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PT
                  </div>
                  <div>
                    <span class="manual-check"
                      ><span class="checkbox"></span></span
                    >PI
                  </div>
                </div>
              </td>
              <td>DN-9527</td>
              <td>40</td>
              <td>1160</td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ========== NOTES SECTION ========== -->
      <div class="section">
        <h2>Transaction Type Legend & Instructions</h2>
        <div class="notes-section">
          <ol>
            <li>
              <strong>CC:</strong> Cycle Count, <strong>Ad+:</strong> Add
              Adjustment, <strong>Ad-:</strong> Decrease Adjustment,
              <strong>PT:</strong> Putaway, <strong>PI:</strong> Physical
              Inventory
            </li>
            <li>
              When transaction Type = CC, QTY = BALANCE; Otherwise, need
              calculate. QTY +/- old Balance = new Balance
            </li>
            <li>
              When a form extends to the following year, fill in the year on a
              separate line.
            </li>
            <li>
              Rcv Date: Oldest received date; if there are multiple dates, print
              oldest date.
            </li>
            <li>
              Expy Date: Oldest expiry date; if there are multiple dates, print
              oldest date.
            </li>
            <li>
              Left QR, Location, Reprint, scan QR, print a new form, include
              initial Balance. Qty +1; when Location is empty, reset Qty to 1.
            </li>
            <li>
              Right QR: Loc+date+unique No+seq. Scan this QR code to take a
              photo and upload.
            </li>
            <li>
              D: If this location is a damage location, print this "Sign". If
              not, nothing prints.
            </li>
            <li>
              After the form is filled out completely or location is empty, it
              is signed by the supervisor, collected, saved, and a new form is
              printed if needed.
            </li>
          </ol>
        </div>
      </div>
    </div>
  </body>

  <script>
    window.triggerPrint = async function (type) {
      try {
        // Check if we're running locally (file:// protocol)
        if (window.location.protocol === "file:") {
          window.print();
          return;
        }

        const res = await fetch(`/api/print?type=${type}`);
        const json = await res.json();
        if (!json.ok) throw new Error(json.error || "Print failed");

        // If server says to use window.print (for letter-size docs), do that
        if (json.useWindowPrint) {
          window.print();
          return;
        }

        alert("Sent to printer");
      } catch (e) {
        alert("Print error: " + e.message);
      }
    };
  </script>
</html>
